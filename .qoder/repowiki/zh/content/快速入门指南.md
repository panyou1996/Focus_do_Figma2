# 快速入门指南

<cite>
**本文档引用的文件**
- [README.md](file://README.md)
- [package.json](file://package.json)
- [.npmrc](file://.npmrc)
- [ANDROID_BUILD_GUIDE.md](file://ANDROID_BUILD_GUIDE.md)
- [capacitor.config.json](file://capacitor.config.json)
- [src/main.tsx](file://src/main.tsx)
- [src/App.tsx](file://src/App.tsx)
- [CAPACITOR_SUMMARY.md](file://CAPACITOR_SUMMARY.md)
</cite>

## 目录
1. [项目简介](#项目简介)
2. [环境要求](#环境要求)
3. [项目搭建](#项目搭建)
4. [开发环境配置](#开发环境配置)
5. [本地开发服务器启动](#本地开发服务器启动)
6. [Capacitor Android平台构建](#capacitor-android平台构建)
7. [常见问题解决](#常见问题解决)
8. [性能优化建议](#性能优化建议)
9. [发布准备](#发布准备)

## 项目简介

Focus Do是一个现代化的任务管理应用，采用React + TypeScript技术栈，结合Capacitor框架实现跨平台移动应用开发。项目专注于"今日视图"的时间轴任务组织和未来自动任务规划，提供极简而精致的UI/UX设计，包含优雅动画和符合iOS和Android标准的一致设计。

### 核心功能
- **任务管理**: 任务、列表、日历、今日视图管理
- **Capacitor支持**: 可编译为Android APK，适配移动设备UI
- **日历增强**: 双击日期快速添加任务，切换任务显示模式
- **FAB重设计**: 单击添加任务，双击快速签到，长按自然语言创建任务
- **用户管理**: 登录/登出、云同步、字体大小、密码修改

**章节来源**
- [README.md](file://README.md#L1-L48)

## 环境要求

### Node.js和npm版本要求

根据项目配置，需要以下环境：

#### Node.js版本要求
- **最低版本**: Node.js 16.x 或更高
- **推荐版本**: Node.js 18.x 或 20.x
- **验证方法**: `node --version`

#### npm配置
项目使用自定义的npm注册表配置：

```bash
# 查看npm配置
npm config get registry
# 输出应为: https://registry.npmjs.org/

# 查看JSR注册表配置
cat .npmrc
# 输出应包含: @jsr:registry=https://npm.jsr.io
```

**章节来源**
- [package.json](file://package.json#L1-L81)
- [.npmrc](file://.npmrc#L1-L3)

## 项目搭建

### 步骤1：克隆项目

```bash
# 克隆项目到本地
git clone <repository-url>
cd Focus_do_Figma2

# 验证项目目录结构
ls -la
# 应该看到项目的主要目录结构
```

### 步骤2：安装依赖包

```bash
# 安装项目依赖（推荐使用npm）
npm install

# 验证依赖安装
npm list --depth=0
# 应该看到所有列出的依赖包
```

### 步骤3：验证环境配置

```bash
# 检查Node.js版本
node --version
# 应该返回16.x或更高版本

# 检查npm版本
npm --version
# 应该返回6.x或更高版本

# 检查Git版本（如果需要）
git --version
# 应该返回2.x或更高版本
```

**章节来源**
- [package.json](file://package.json#L1-L81)

## 开发环境配置

### Android Studio配置

为了构建Android APK，需要配置Android开发环境：

#### 1. 安装Android Studio
- 下载地址: https://developer.android.com/studio
- 推荐版本: Electric Eel 或更新版本

#### 2. 配置Android SDK
打开Android Studio，进入 `Tools` > `SDK Manager`，确保安装以下组件：
- Android SDK Platform 33 (或最新版本)
- Android SDK Build-Tools 33.0.0 (或最新版本)
- Android SDK Platform-Tools
- Android SDK Tools

#### 3. 设置环境变量
在系统PATH中添加以下环境变量：
```bash
ANDROID_HOME=C:\Users\[username]\AppData\Local\Android\Sdk
```

#### 4. 验证Android SDK配置
```bash
# 检查Android SDK路径
echo $ANDROID_HOME

# 验证SDK工具可用性
adb version
# 应该返回ADB version信息
```

### Java Development Kit (JDK)配置

- **JDK版本**: JDK 11 或更高版本
- **Android Studio通常会自动安装JDK**
- **验证方法**: `java -version`

**章节来源**
- [ANDROID_BUILD_GUIDE.md](file://ANDROID_BUILD_GUIDE.md#L1-L58)

## 本地开发服务器启动

### 启动开发服务器

```bash
# 启动开发服务器
npm run dev

# 默认情况下，开发服务器会在以下地址启动
# http://localhost:3000
```

### 开发服务器功能

开发服务器提供以下功能：

1. **热重载**: 修改代码后自动刷新浏览器
2. **TypeScript支持**: 实时编译TypeScript文件
3. **CSS预处理**: 支持Tailwind CSS和PostCSS
4. **React开发工具**: 支持React组件开发

### 访问开发应用

打开浏览器访问：
- **主应用**: http://localhost:3000
- **开发工具**: 可以使用React DevTools进行调试

### 常用开发命令

```bash
# 构建生产版本
npm run build

# 同步到原生平台
npm run cap:sync

# 打开Android Studio
npm run cap:android

# 构建并运行Android应用
npm run cap:run:android
```

**章节来源**
- [package.json](file://package.json#L60-L67)
- [src/main.tsx](file://src/main.tsx#L1-L8)

## Capacitor Android平台构建

### 构建步骤概述

Focus Do项目使用Capacitor框架将React应用转换为原生Android应用。以下是完整的构建流程：

#### 方法1：快速构建（推荐）

```bash
# 一键构建Web应用并打开Android Studio
npm run cap:build:android
```

这个命令会执行以下步骤：
1. 构建Web应用：`npm run build`
2. 同步到Android项目：`npx cap sync android`
3. 打开Android Studio：`npx cap open android`

#### 方法2：分步构建

```bash
# 第1步：构建Web应用
npm run build

# 第2步：同步到Android项目
npx cap sync android

# 第3步：打开Android Studio
npx cap open android
```

### 在Android Studio中构建APK

#### 调试版APK（开发测试用）

1. 在Android Studio中，选择 `Build` > `Build Bundle(s) / APK(s)` > `Build APK(s)`
2. 等待构建完成
3. APK位置: `android/app/build/outputs/apk/debug/app-debug.apk`

#### 发布版APK（正式发布用）

1. **生成签名密钥**：
```bash
keytool -genkey -v -keystore focus-do-key.keystore -alias focus-do -keyalg RSA -keysize 2048 -validity 10000
```

2. **在Android Studio中配置发布构建**：
   - 选择 `Build` > `Generate Signed Bundle / APK`
   - 选择 APK
   - 选择或创建密钥库
   - 选择发布构建类型
   - 点击 `Build`

3. 发布APK位置: `android/app/build/outputs/apk/release/app-release.apk`

### 原生功能特性

Focus Do应用集成了多种原生功能：

#### ✅ 已实现的原生功能
- 🎯 **触觉反馈**: 任务完成、重要性切换、长按等操作的触觉反馈
- 📱 **状态栏控制**: 动态调整状态栏样式（深色/浅色）
- 🚀 **启动屏幕**: 自定义启动动画和品牌展示
- 🔔 **Toast通知**: 原生消息提示
- 📐 **安全区域适配**: 完美支持Notch屏、动态岛、底部小白条
- 🎨 **移动端UI优化**: 针对移动设备的交互和视觉优化

#### 📱 支持的设备类型
- iPhone X/XS/XR/11/12/13/14系列 (Notch屏)
- iPhone 14 Pro系列 (动态岛)
- Android设备 (刘海屏、水滴屏、打孔屏)
- 可折叠屏设备
- 各种屏幕尺寸和分辨率

**章节来源**
- [ANDROID_BUILD_GUIDE.md](file://ANDROID_BUILD_GUIDE.md#L59-L182)
- [capacitor.config.json](file://capacitor.config.json#L1-L22)

## 常见问题解决

### Gradle构建失败

```bash
# 清理Gradle缓存
cd android
./gradlew clean

# 重新构建
./gradlew assembleDebug
```

### Android SDK路径问题

确保在 `android/local.properties` 中设置正确的SDK路径：
```properties
sdk.dir=C:\\Users\\[username]\\AppData\\Local\\Android\\Sdk
```

### 权限被拒绝

在Android Studio中检查 `AndroidManifest.xml` 文件，确保所需权限都已添加。

### 原生插件错误

```bash
# 重新安装Capacitor插件
npm install @capacitor/haptics @capacitor/status-bar @capacitor/splash-screen
npx cap sync android
```

### 设备连接问题

```bash
# 检查设备连接
adb devices

# 如果设备未显示，尝试重启ADB服务
adb kill-server
adb start-server

# 启用开发者选项和USB调试
# 在Android设备上：Settings > About phone > Tap Build number 7 times
# 返回：Settings > Developer options > Enable USB debugging
```

### 调试工具

#### Chrome DevTools调试
1. 在Android设备上启用开发者选项和USB调试
2. 连接设备到电脑
3. 在Chrome中访问 `chrome://inspect`
4. 选择你的应用进行调试

#### Android Studio Logcat
查看应用运行时的日志输出，快速定位问题。

**章节来源**
- [ANDROID_BUILD_GUIDE.md](file://ANDROID_BUILD_GUIDE.md#L120-L170)

## 性能优化建议

### 代码分割
使用动态导入减少初始加载时间：
```javascript
// 使用动态导入
const LazyComponent = lazy(() => import('./HeavyComponent'));
```

### 图片优化
使用WebP格式和适当的压缩：
```html
<!-- 使用WebP格式 -->
<img src="image.webp" alt="Description">
```

### 缓存策略
利用Service Worker缓存静态资源：
```javascript
// 在service-worker.js中配置缓存策略
self.addEventListener('fetch', (event) => {
  // 自定义缓存逻辑
});
```

### 懒加载
对大型组件实施懒加载：
```javascript
// 使用React.lazy和Suspense
const HeavyComponent = React.lazy(() => import('./HeavyComponent'));

function App() {
  return (
    <React.Suspense fallback={<div>Loading...</div>}>
      <HeavyComponent />
    </React.Suspense>
  );
}
```

### Bundle分析
使用工具分析和优化打包大小：
```bash
# 分析打包大小
npm run build -- --analyze

# 使用webpack-bundle-analyzer
npx webpack-bundle-analyzer build/static/js/main.*.chunk.js
```

**章节来源**
- [ANDROID_BUILD_GUIDE.md](file://ANDROID_BUILD_GUIDE.md#L183-L195)

## 发布准备

### 发布前检查清单

- [ ] 测试所有核心功能
- [ ] 验证不同屏幕尺寸的适配
- [ ] 检查权限请求的必要性
- [ ] 优化APK大小
- [ ] 测试离线功能
- [ ] 验证数据同步
- [ ] 检查安全配置

### Google Play商店准备

1. **创建应用图标**（各种尺寸）
2. **准备应用截图**（手机和平板）
3. **编写应用描述**
4. **设置应用分类和关键词**
5. **配置内容分级**
6. **测试发布版APK**

### 应用配置信息

- **应用名称**: Focus Do
- **包名**: com.focusdo.app
- **版本**: 0.1.0
- **主要技术栈**:
  - 前端框架: React 18 + TypeScript
  - UI组件: Radix UI + Tailwind CSS
  - 动画: Framer Motion
  - 移动端框架: Capacitor 7
  - 后端服务: Supabase (认证、数据库、实时同步)

**章节来源**
- [ANDROID_BUILD_GUIDE.md](file://ANDROID_BUILD_GUIDE.md#L171-L182)
- [capacitor.config.json](file://capacitor.config.json#L1-L22)

## 结论

通过本快速入门指南，您已经掌握了从零开始搭建Focus Do项目的本地开发环境，包括：

1. **环境配置**: Node.js、npm、Android Studio的正确安装和配置
2. **项目搭建**: 克隆项目、安装依赖、验证环境
3. **开发服务器**: 启动本地开发服务器并进行开发
4. **Android构建**: 使用Capacitor将Web应用转换为Android APK
5. **问题解决**: 常见问题的诊断和解决方案
6. **性能优化**: 提升应用性能的最佳实践

现在您可以开始探索Focus Do项目的源代码，进行功能开发或bug修复。记住使用提供的npm脚本来简化开发流程，并充分利用Android Studio的强大调试功能。

如果您在开发过程中遇到任何问题，请参考项目的详细文档或联系项目维护团队。祝您开发愉快！