# æ„å»ºä¸éƒ¨ç½²

<cite>
**æœ¬æ–‡æ¡£å¼•ç”¨çš„æ–‡ä»¶**
- [README.md](file://README.md)
- [ANDROID_BUILD_GUIDE.md](file://ANDROID_BUILD_GUIDE.md)
- [CAPACITOR_SUMMARY.md](file://CAPACITOR_SUMMARY.md)
- [STORAGE_SETUP_GUIDE.md](file://STORAGE_SETUP_GUIDE.md)
- [package.json](file://package.json)
- [capacitor.config.json](file://capacitor.config.json)
- [android\app\src\main\AndroidManifest.xml](file://android\app\src\main\AndroidManifest.xml)
- [android\app\src\main\assets\capacitor.config.json](file://android\app\src\main\assets\capacitor.config.json)
- [src\utils\nativeService.ts](file://src\utils\nativeService.ts)
- [src\styles\mobile.css](file://src\styles\mobile.css)
</cite>

## ç›®å½•
1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æ„å»ºç¯å¢ƒé…ç½®](#æ„å»ºç¯å¢ƒé…ç½®)
3. [Capacitoræ ¸å¿ƒé…ç½®](#capacitoræ ¸å¿ƒé…ç½®)
4. [Androidæ„å»ºæµç¨‹](#androidæ„å»ºæµç¨‹)
5. [åŸç”ŸåŠŸèƒ½é›†æˆ](#åŸç”ŸåŠŸèƒ½é›†æˆ)
6. [å­˜å‚¨é…ç½®](#å­˜å‚¨é…ç½®)
7. [è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬](#è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬)
8. [CI/CDé›†æˆ](#cicdé›†æˆ)
9. [æ€§èƒ½ä¼˜åŒ–å»ºè®®](#æ€§èƒ½ä¼˜åŒ–å»ºè®®)
10. [æ•…éšœæ’é™¤æŒ‡å—](#æ•…éšœæ’é™¤æŒ‡å—)

## é¡¹ç›®æ¦‚è¿°

Focus Doæ˜¯ä¸€ä¸ªåŸºäºReact 18 + TypeScriptçš„ç°ä»£åŒ–ä»»åŠ¡ç®¡ç†åº”ç”¨ï¼Œé‡‡ç”¨Capacitor 7æ¡†æ¶å®ç°è·¨å¹³å°ç§»åŠ¨åº”ç”¨å¼€å‘ã€‚è¯¥é¡¹ç›®æ”¯æŒAndroid APKå’ŒiOSåº”ç”¨çš„æ„å»ºï¼Œå…·å¤‡å®Œæ•´çš„åŸç”ŸåŠŸèƒ½é›†æˆï¼ŒåŒ…æ‹¬è§¦è§‰åé¦ˆã€çŠ¶æ€æ æ§åˆ¶ã€å¯åŠ¨å±å¹•ã€Toasté€šçŸ¥ç­‰ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **ç§»åŠ¨ç«¯åŸç”Ÿä½“éªŒ**: é€šè¿‡Capacitorå®ç°çœŸæ­£çš„åŸç”ŸåŠŸèƒ½
- **ç°ä»£ç§»åŠ¨ç«¯é€‚é…**: æ”¯æŒæœ€æ–°çš„ç§»åŠ¨è®¾å¤‡ç‰¹æ€§
- **å®æ—¶æ•°æ®åŒæ­¥**: åŸºäºSupabaseçš„äº‘ç«¯åŒæ­¥
- **é«˜æ€§èƒ½æ¶æ„**: Viteæ„å»º + React 18 + TypeScript
- **è·¨å¹³å°æ”¯æŒ**: åŒæ—¶æ”¯æŒAndroidå’ŒiOSå¹³å°

**ç« èŠ‚æ¥æº**
- [README.md](file://README.md#L1-L48)
- [CAPACITOR_SUMMARY.md](file://CAPACITOR_SUMMARY.md#L1-L50)

## æ„å»ºç¯å¢ƒé…ç½®

### ç³»ç»Ÿè¦æ±‚

æ„å»ºFocus Doåº”ç”¨éœ€è¦ä»¥ä¸‹ç¯å¢ƒé…ç½®ï¼š

#### å¿…éœ€è½¯ä»¶
1. **Android Studio** (æ¨è Electric Eel æˆ–æ›´æ–°ç‰ˆæœ¬)
   - ä¸‹è½½åœ°å€: https://developer.android.com/studio
   - åŒ…å«Android SDKå’Œæ„å»ºå·¥å…·

2. **Java Development Kit (JDK)**
   - JDK 11 æˆ–æ›´é«˜ç‰ˆæœ¬
   - Android Studioé€šå¸¸ä¼šè‡ªåŠ¨å®‰è£…

3. **Node.js** 
   - ç‰ˆæœ¬ 16 æˆ–æ›´é«˜
   - å·²å®‰è£…ï¼Œç”¨äºè¿è¡ŒCapacitor

#### Android SDKé…ç½®

```bash
# æ‰“å¼€Android Studio
# è¿›å…¥ Tools > SDK Manager
# ç¡®ä¿å®‰è£…ä»¥ä¸‹ç»„ä»¶ï¼š
# - Android SDK Platform 33 (æˆ–æœ€æ–°ç‰ˆæœ¬)
# - Android SDK Build-Tools 33.0.0 (æˆ–æœ€æ–°ç‰ˆæœ¬)
# - Android SDK Platform-Tools
# - Android SDK Tools

# è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆåœ¨ç³»ç»ŸPATHä¸­æ·»åŠ ï¼‰
ANDROID_HOME=C:\Users\[username]\AppData\Local\Android\Sdk
```

**ç« èŠ‚æ¥æº**
- [ANDROID_BUILD_GUIDE.md](file://ANDROID_BUILD_GUIDE.md#L1-L50)

## Capacitoræ ¸å¿ƒé…ç½®

### é…ç½®æ–‡ä»¶ç»“æ„

Capacitorçš„æ ¸å¿ƒé…ç½®ä½äºé¡¹ç›®æ ¹ç›®å½•å’ŒAndroidåŸç”Ÿé¡¹ç›®ä¸­ï¼š

```mermaid
graph TB
subgraph "é¡¹ç›®æ ¹ç›®å½•"
Config[capacitor.config.json]
Package[package.json]
end
subgraph "AndroidåŸç”Ÿé¡¹ç›®"
AndroidConfig[android/app/src/main/assets/capacitor.config.json]
Manifest[AndroidManifest.xml]
Plugins[capacitor.plugins.json]
end
Config --> AndroidConfig
Package --> Config
```

**å›¾è¡¨æ¥æº**
- [capacitor.config.json](file://capacitor.config.json#L1-L22)
- [android\app\src\main\assets\capacitor.config.json](file://android\app\src\main\assets\capacitor.config.json#L1-L22)

### åº”ç”¨åŸºæœ¬ä¿¡æ¯

```json
{
  "appId": "com.focusdo.app",
  "appName": "Focus Do",
  "webDir": "build",
  "server": {
    "androidScheme": "https"
  }
}
```

### åŸç”Ÿæ’ä»¶é…ç½®

é¡¹ç›®é›†æˆäº†å¤šä¸ªCapacitoråŸç”Ÿæ’ä»¶ï¼š

- **@capacitor/haptics**: è§¦è§‰åé¦ˆ
- **@capacitor/status-bar**: çŠ¶æ€æ æ§åˆ¶
- **@capacitor/splash-screen**: å¯åŠ¨å±å¹•
- **@capacitor/toast**: åŸç”ŸToasté€šçŸ¥
- **@capacitor/local-notifications**: æœ¬åœ°é€šçŸ¥
- **@capacitor/preferences**: æœ¬åœ°å­˜å‚¨

**ç« èŠ‚æ¥æº**
- [capacitor.config.json](file://capacitor.config.json#L1-L22)
- [android\app\src\main\assets\capacitor.plugins.json](file://android\app\src\main\assets\capacitor.plugins.json#L1-L25)

## Androidæ„å»ºæµç¨‹

### æ„å»ºæ­¥éª¤è¯¦è§£

#### 1. å¿«é€Ÿæ„å»ºï¼ˆæ¨èï¼‰

```bash
# æ„å»ºWebåº”ç”¨å¹¶æ‰“å¼€Android Studio
npm run cap:build:android
```

#### 2. åˆ†æ­¥æ„å»º

```bash
# ç¬¬1æ­¥ï¼šæ„å»ºWebåº”ç”¨
npm run build

# ç¬¬2æ­¥ï¼šåŒæ­¥åˆ°Androidé¡¹ç›®
npx cap sync android

# ç¬¬3æ­¥ï¼šæ‰“å¼€Android Studio
npx cap open android
```

#### 3. åœ¨Android Studioä¸­æ„å»ºAPK

##### è°ƒè¯•ç‰ˆAPK (å¼€å‘æµ‹è¯•ç”¨)

1. åœ¨Android Studioä¸­ï¼Œé€‰æ‹© `Build` > `Build Bundle(s) / APK(s)` > `Build APK(s)`
2. ç­‰å¾…æ„å»ºå®Œæˆ
3. APKä½ç½®: `android/app/build/outputs/apk/debug/app-debug.apk`

##### å‘å¸ƒç‰ˆAPK (æ­£å¼å‘å¸ƒç”¨)

1. ç”Ÿæˆç­¾åå¯†é’¥ï¼š
```bash
keytool -genkey -v -keystore focus-do-key.keystore -alias focus-do -keyalg RSA -keysize 2048 -validity 10000
```

2. åœ¨Android Studioä¸­ï¼š
   - é€‰æ‹© `Build` > `Generate Signed Bundle / APK`
   - é€‰æ‹© APK
   - é€‰æ‹©æˆ–åˆ›å»ºå¯†é’¥åº“
   - é€‰æ‹©å‘å¸ƒæ„å»ºç±»å‹
   - ç‚¹å‡» `Build`

3. å‘å¸ƒAPKä½ç½®: `android/app/build/outputs/apk/release/app-release.apk`

### æ„å»ºæµç¨‹å›¾

```mermaid
flowchart TD
Start([å¼€å§‹æ„å»º]) --> BuildWeb["æ„å»ºWebåº”ç”¨<br/>npm run build"]
BuildWeb --> SyncCapacitor["åŒæ­¥åˆ°Android<br/>npx cap sync android"]
SyncCapacitor --> OpenStudio["æ‰“å¼€Android Studio<br/>npx cap open android"]
OpenStudio --> DebugBuild{"è°ƒè¯•ç‰ˆè¿˜æ˜¯<br/>å‘å¸ƒç‰ˆ?"}
DebugBuild --> |è°ƒè¯•ç‰ˆ| DebugAPK["Build APK(s)<br/>app-debug.apk"]
DebugBuild --> |å‘å¸ƒç‰ˆ| SignKey["ç”Ÿæˆç­¾åå¯†é’¥"]
SignKey --> ReleaseAPK["ç”Ÿæˆå‘å¸ƒAPK<br/>app-release.apk"]
DebugAPK --> Test["æµ‹è¯•APK"]
ReleaseAPK --> Test
Test --> Deploy["éƒ¨ç½²å‘å¸ƒ"]
```

**å›¾è¡¨æ¥æº**
- [ANDROID_BUILD_GUIDE.md](file://ANDROID_BUILD_GUIDE.md#L50-L120)

**ç« èŠ‚æ¥æº**
- [ANDROID_BUILD_GUIDE.md](file://ANDROID_BUILD_GUIDE.md#L50-L150)

## åŸç”ŸåŠŸèƒ½é›†æˆ

### NativeServiceæ¶æ„

é¡¹ç›®å®ç°äº†å®Œæ•´çš„åŸç”ŸæœåŠ¡å±‚ï¼Œé€šè¿‡NativeServiceç±»å°è£…æ‰€æœ‰CapacitoråŸç”ŸåŠŸèƒ½ï¼š

```mermaid
classDiagram
class NativeService {
+hapticLight() Promise~void~
+hapticMedium() Promise~void~
+hapticHeavy() Promise~void~
+setStatusBarLight() Promise~void~
+setStatusBarDark() Promise~void~
+hideStatusBar() Promise~void~
+showStatusBar() Promise~void~
+hideSplashScreen() Promise~void~
+showToast(message, duration) Promise~void~
+isNative() boolean
+getPlatform() string
}
class SafeAreaStyles {
+statusBarPadding string
+bottomSafePadding string
+fullSafePadding string
+minHeightScreen string
}
class MobileCSS {
+injectSafeAreaCSS() void
}
NativeService --> SafeAreaStyles : "ä½¿ç”¨"
NativeService --> MobileCSS : "é›†æˆ"
```

**å›¾è¡¨æ¥æº**
- [src\utils\nativeService.ts](file://src\utils\nativeService.ts#L1-L180)
- [src\styles\mobile.css](file://src\styles\mobile.css#L1-L50)

### æ”¯æŒçš„åŸç”ŸåŠŸèƒ½

#### âœ… å·²å®ç°çš„åŸç”ŸåŠŸèƒ½

- **ğŸ¯ Hapticåé¦ˆ**: ä»»åŠ¡å®Œæˆã€é‡è¦æ€§åˆ‡æ¢ã€é•¿æŒ‰ç­‰æ“ä½œçš„è§¦è§‰åé¦ˆ
- **ğŸ“± çŠ¶æ€æ æ§åˆ¶**: åŠ¨æ€è°ƒæ•´çŠ¶æ€æ æ ·å¼ï¼ˆæ·±è‰²/æµ…è‰²ï¼‰
- **ğŸš€ å¯åŠ¨å±å¹•**: è‡ªå®šä¹‰å¯åŠ¨åŠ¨ç”»å’Œå“ç‰Œå±•ç¤º
- **ğŸ”” Toasté€šçŸ¥**: åŸç”Ÿæ¶ˆæ¯æç¤º
- **ğŸ“ å®‰å…¨åŒºåŸŸé€‚é…**: å®Œç¾æ”¯æŒNotchå±ã€åŠ¨æ€å²›ã€åº•éƒ¨å°ç™½æ¡
- **ğŸ¨ ç§»åŠ¨ç«¯UIä¼˜åŒ–**: é’ˆå¯¹ç§»åŠ¨è®¾å¤‡çš„äº¤äº’å’Œè§†è§‰ä¼˜åŒ–

#### ğŸ“± æ”¯æŒçš„è®¾å¤‡ç±»å‹

- iPhone X/XS/XR/11/12/13/14ç³»åˆ— (Notchå±)
- iPhone 14 Proç³»åˆ— (åŠ¨æ€å²›)
- Androidè®¾å¤‡ (åˆ˜æµ·å±ã€æ°´æ»´å±ã€æ‰“å­”å±)
- å¯æŠ˜å å±è®¾å¤‡
- å„ç§å±å¹•å°ºå¯¸å’Œåˆ†è¾¨ç‡

### åŸç”ŸåŠŸèƒ½è°ƒç”¨ç¤ºä¾‹

```typescript
// è§¦è§‰åé¦ˆç¤ºä¾‹
await NativeService.hapticLight(); // è½»åº¦éœ‡åŠ¨
await NativeService.hapticMedium(); // ä¸­åº¦éœ‡åŠ¨
await NativeService.hapticHeavy(); // é‡åº¦éœ‡åŠ¨

// çŠ¶æ€æ æ§åˆ¶ç¤ºä¾‹
await NativeService.setStatusBarDark();
await NativeService.hideStatusBar();

// Toasté€šçŸ¥ç¤ºä¾‹
await NativeService.showToast('ä»»åŠ¡å·²ä¿å­˜', 'short');
```

**ç« èŠ‚æ¥æº**
- [src\utils\nativeService.ts](file://src\utils\nativeService.ts#L1-L180)
- [ANDROID_BUILD_GUIDE.md](file://ANDROID_BUILD_GUIDE.md#L80-L120)

## å­˜å‚¨é…ç½®

### Supabaseå­˜å‚¨æ¡¶è®¾ç½®

ä¸ºäº†æ”¯æŒå›¾ç‰‡ä¸Šä¼ åŠŸèƒ½ï¼Œéœ€è¦æ­£ç¡®é…ç½®Supabaseå­˜å‚¨æ¡¶ï¼š

#### å¿«é€Ÿè§£å†³æ–¹æ¡ˆ

1. **åˆ›å»ºå­˜å‚¨æ¡¶**
   - æ‰“å¼€Supabaseæ§åˆ¶å°
   - é€‰æ‹©é¡¹ç›® > Storage > Create bucket
   - è¾“å…¥æ¡¶åç§°ï¼š`images`
   - é€‰æ‹© "Public bucket" (å…è®¸å…¬å¼€è®¿é—®)

2. **è®¾ç½®è®¿é—®ç­–ç•¥**
   - åœ¨Storageé¡µé¢ç‚¹å‡»åˆšåˆ›å»ºçš„ "images" æ¡¶
   - ç‚¹å‡» "Policies" æ ‡ç­¾
   - æ·»åŠ ä»¥ä¸‹ä¸‰ä¸ªç­–ç•¥ï¼š

#### ç­–ç•¥é…ç½®

**ç­–ç•¥1ï¼šå…è®¸è®¤è¯ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡**
```sql
Policy Name: Allow authenticated users to upload images
Allowed operation: INSERT
Target roles: authenticated
Policy definition: bucket_id = 'images'
```

**ç­–ç•¥2ï¼šå…è®¸æ‰€æœ‰äººæŸ¥çœ‹å›¾ç‰‡**
```sql
Policy Name: Allow public to view images
Allowed operation: SELECT
Target roles: public
Policy definition: bucket_id = 'images'
```

**ç­–ç•¥3ï¼šå…è®¸ç”¨æˆ·åˆ é™¤è‡ªå·±çš„å›¾ç‰‡**
```sql
Policy Name: Allow users to delete own images
Allowed operation: DELETE
Target roles: authenticated
Policy definition: bucket_id = 'images' AND auth.uid()::text = (storage.foldername(name))[1]
```

### å­˜å‚¨æ¡¶éªŒè¯

å®Œæˆè®¾ç½®åï¼š
1. åˆ·æ–°åº”ç”¨é¡µé¢
2. å°è¯•åœ¨Blogåˆ›å»ºä¸­ä¸Šä¼ å›¾ç‰‡
3. åº”è¯¥èƒ½å¤ŸæˆåŠŸä¸Šä¼ 

**ç« èŠ‚æ¥æº**
- [STORAGE_SETUP_GUIDE.md](file://STORAGE_SETUP_GUIDE.md#L1-L80)

## è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬

### package.jsonä¸­çš„æ„å»ºè„šæœ¬

é¡¹ç›®æä¾›äº†å®Œæ•´çš„è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬é›†åˆï¼š

```json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "cap:sync": "cap sync",
    "cap:android": "cap open android",
    "cap:build:android": "npm run build && cap sync android && cap open android",
    "cap:run:android": "npm run build && cap sync android && cap run android"
  }
}
```

### è„šæœ¬åŠŸèƒ½è¯´æ˜

#### å¼€å‘ç¯å¢ƒ
- `npm run dev`: å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œæ”¯æŒçƒ­é‡è½½

#### æ„å»ºç¯å¢ƒ
- `npm run build`: æ„å»ºWebåº”ç”¨åˆ° `build/` ç›®å½•

#### Capacitoré›†æˆ
- `npm run cap:sync`: åŒæ­¥Webæ„å»ºåˆ°åŸç”Ÿå¹³å°
- `npm run cap:android`: æ‰“å¼€Android Studio
- `npm run cap:build:android`: å®Œæ•´æ„å»ºæµç¨‹ï¼ˆæ¨èï¼‰
- `npm run cap:run:android`: æ„å»ºã€åŒæ­¥å¹¶è¿è¡Œåˆ°è®¾å¤‡

### æ„å»ºè„šæœ¬æµç¨‹

```mermaid
sequenceDiagram
participant Dev as å¼€å‘è€…
participant NPM as npm scripts
participant Vite as Viteæ„å»ºå™¨
participant Capacitor as Capacitor CLI
participant Android as Android Studio
Dev->>NPM : npm run cap : build : android
NPM->>Vite : npm run build
Vite-->>NPM : æ„å»ºå®Œæˆ (build/)
NPM->>Capacitor : cap sync android
Capacitor->>Capacitor : åŒæ­¥Webèµ„æºåˆ°Android
NPM->>Android : cap open android
Android-->>Dev : æ‰“å¼€Android Studio
```

**å›¾è¡¨æ¥æº**
- [package.json](file://package.json#L40-L50)

**ç« èŠ‚æ¥æº**
- [package.json](file://package.json#L40-L50)

## CI/CDé›†æˆ

### GitHub Actionså·¥ä½œæµé…ç½®

#### åŸºç¡€å·¥ä½œæµç»“æ„

```yaml
name: Android Build & Deploy

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        
    - name: Install Dependencies
      run: npm ci
      
    - name: Run Tests
      run: npm test
      
    - name: Build Web App
      run: npm run build
      
    - name: Setup Java
      uses: actions/setup-java@v3
      with:
        java-version: '11'
        distribution: 'temurin'
        
    - name: Setup Android SDK
      uses: android-actions/setup-android@v2
      
    - name: Build Android APK
      run: |
        npm run cap:build:android
        cd android
        ./gradlew assembleRelease
        
    - name: Upload APK
      uses: actions/upload-artifact@v3
      with:
        name: app-release
        path: android/app/build/outputs/apk/release/app-release.apk
```

#### å…³é”®é…ç½®è¦ç‚¹

1. **ç¯å¢ƒå‡†å¤‡**
   - Node.js 18+ (æ”¯æŒESMæ¨¡å—)
   - Java 11 (Androidæ„å»ºè¦æ±‚)
   - Android SDK (åŒ…å«å¿…è¦çš„æ„å»ºå·¥å…·)

2. **æ„å»ºä¼˜åŒ–**
   - ä½¿ç”¨ `npm ci` å®‰è£…ç²¾ç¡®ç‰ˆæœ¬ä¾èµ–
   - å¯ç”¨æ„å»ºç¼“å­˜
   - å¹¶è¡Œæ‰§è¡Œæµ‹è¯•å’Œæ„å»º

3. **ç­¾åé…ç½®**
   - å°†ç­¾åå¯†é’¥ä½œä¸ºGitHub Secretså­˜å‚¨
   - åœ¨å·¥ä½œæµä¸­è§£å¯†å¹¶é…ç½®åˆ°æ„å»ºç¯å¢ƒ

4. **éƒ¨ç½²ç­–ç•¥**
   - è‡ªåŠ¨æ„å»ºå‘å¸ƒç‰ˆAPK
   - æ”¯æŒé¢„å‘å¸ƒç‰ˆæœ¬
   - é›†æˆGoogle Play Console API

### æŒç»­éƒ¨ç½²æœ€ä½³å®è·µ

#### 1. åˆ†æ”¯ç­–ç•¥
- `main` åˆ†æ”¯è‡ªåŠ¨æ„å»ºå‘å¸ƒç‰ˆ
- `develop` åˆ†æ”¯æ„å»ºè°ƒè¯•ç‰ˆ
- `release/*` åˆ†æ”¯æ„å»ºé¢„å‘å¸ƒç‰ˆ

#### 2. ç‰ˆæœ¬ç®¡ç†
```bash
# è‡ªåŠ¨ç‰ˆæœ¬å·é€’å¢
npm version patch
git push --tags
```

#### 3. è´¨é‡é—¨ç¦
- ä»£ç è¦†ç›–ç‡å¿…é¡»è¾¾åˆ°80%
- é™æ€ä»£ç åˆ†æé€šè¿‡
- æ€§èƒ½åŸºå‡†æµ‹è¯•è¾¾æ ‡

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### ä»£ç åˆ†å‰²ä¸æ‡’åŠ è½½

1. **åŠ¨æ€å¯¼å…¥ä¼˜åŒ–**
```javascript
// ä½¿ç”¨åŠ¨æ€å¯¼å…¥å‡å°‘åˆå§‹åŠ è½½æ—¶é—´
const LazyComponent = lazy(() => import('./HeavyComponent'));

// å®æ–½ç»„ä»¶æ‡’åŠ è½½
<Suspense fallback={<Loading />}>
  <LazyComponent />
</Suspense>
```

2. **å›¾ç‰‡ä¼˜åŒ–**
```html
<!-- ä½¿ç”¨WebPæ ¼å¼ -->
<img src="image.webp" alt="ä¼˜åŒ–å›¾ç‰‡" />

<!-- å®æ–½å›¾ç‰‡æ‡’åŠ è½½ -->
<img src="placeholder.jpg" 
     data-src="optimized-image.jpg" 
     loading="lazy" />
```

### ç¼“å­˜ç­–ç•¥

1. **Service Workerç¼“å­˜**
```javascript
// æ³¨å†ŒService Worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/sw.js')
      .then(registration => {
        console.log('SW registered: ', registration);
      })
      .catch(registrationError => {
        console.log('SW registration failed: ', registrationError);
      });
  });
}
```

2. **é™æ€èµ„æºç¼“å­˜**
```javascript
// ç¼“å­˜ç­–ç•¥é…ç½®
const CACHE_NAME = 'focus-do-cache-v1';
const urlsToCache = [
  '/',
  '/static/js/bundle.js',
  '/static/css/main.css'
];
```

### APKå¤§å°ä¼˜åŒ–

1. **ç§»é™¤æœªä½¿ç”¨çš„ä¾èµ–**
```bash
# åˆ†æä¾èµ–æ ‘
npm ls --depth=0

# ç§»é™¤æœªä½¿ç”¨çš„åŒ…
npm uninstall unused-package
```

2. **ä»£ç å‹ç¼©**
```javascript
// Viteé…ç½®ä¸­çš„å‹ç¼©é€‰é¡¹
export default {
  build: {
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true
      }
    }
  }
}
```

## æ•…éšœæ’é™¤æŒ‡å—

### å¸¸è§æ„å»ºé—®é¢˜

#### 1. Gradleæ„å»ºå¤±è´¥

```bash
# æ¸…ç†Gradleç¼“å­˜
cd android
./gradlew clean

# é‡æ–°æ„å»º
./gradlew assembleDebug
```

#### 2. Android SDKè·¯å¾„é—®é¢˜

ç¡®ä¿åœ¨ `android/local.properties` ä¸­è®¾ç½®æ­£ç¡®çš„SDKè·¯å¾„ï¼š
```properties
sdk.dir=C:\\Users\\[username]\\AppData\\Local\\Android\\Sdk
```

#### 3. æƒé™è¢«æ‹’ç»

åœ¨Android Studioä¸­æ£€æŸ¥ `AndroidManifest.xml` æ–‡ä»¶ï¼Œç¡®ä¿æ‰€éœ€æƒé™éƒ½å·²æ·»åŠ ã€‚

#### 4. åŸç”Ÿæ’ä»¶é”™è¯¯

```bash
# é‡æ–°å®‰è£…Capacitoræ’ä»¶
npm install @capacitor/haptics @capacitor/status-bar @capacitor/splash-screen
npx cap sync android
```

### è°ƒè¯•å·¥å…·

#### 1. Chrome DevToolsè°ƒè¯•
1. åœ¨Androidè®¾å¤‡ä¸Šå¯ç”¨å¼€å‘è€…é€‰é¡¹å’ŒUSBè°ƒè¯•
2. è¿æ¥è®¾å¤‡åˆ°ç”µè„‘
3. åœ¨Chromeä¸­è®¿é—® `chrome://inspect`
4. é€‰æ‹©ä½ çš„åº”ç”¨è¿›è¡Œè°ƒè¯•

#### 2. Android Studio Logcat
æŸ¥çœ‹åº”ç”¨è¿è¡Œæ—¶çš„æ—¥å¿—è¾“å‡ºï¼Œå¿«é€Ÿå®šä½é—®é¢˜ã€‚

### å‘å¸ƒå‰æ£€æŸ¥æ¸…å•

- [ ] æµ‹è¯•æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½
- [ ] éªŒè¯ä¸åŒå±å¹•å°ºå¯¸çš„é€‚é…
- [ ] æ£€æŸ¥æƒé™è¯·æ±‚çš„å¿…è¦æ€§
- [ ] ä¼˜åŒ–APKå¤§å°
- [ ] æµ‹è¯•ç¦»çº¿åŠŸèƒ½
- [ ] éªŒè¯æ•°æ®åŒæ­¥
- [ ] æ£€æŸ¥å®‰å…¨é…ç½®

**ç« èŠ‚æ¥æº**
- [ANDROID_BUILD_GUIDE.md](file://ANDROID_BUILD_GUIDE.md#L150-L196)

## ç»“è®º

é€šè¿‡æœ¬æ–‡æ¡£çš„æŒ‡å¯¼ï¼Œå¼€å‘è€…å¯ä»¥å®Œæ•´åœ°æŒæ¡Focus Doåº”ç”¨çš„æ„å»ºä¸éƒ¨ç½²æµç¨‹ã€‚ä»ç¯å¢ƒé…ç½®åˆ°CI/CDé›†æˆï¼Œä»åŸç”ŸåŠŸèƒ½é›†æˆåˆ°æ€§èƒ½ä¼˜åŒ–ï¼Œæ¯ä¸ªç¯èŠ‚éƒ½æœ‰è¯¦ç»†çš„è¯´æ˜å’Œæœ€ä½³å®è·µå»ºè®®ã€‚

### å…³é”®è¦ç‚¹æ€»ç»“

1. **ç¯å¢ƒå‡†å¤‡**: ç¡®ä¿Android Studioã€JDKå’ŒNode.jsæ­£ç¡®å®‰è£…é…ç½®
2. **Capacitoré›†æˆ**: æ­£ç¡®é…ç½®åŸç”Ÿæ’ä»¶å’Œåº”ç”¨å‚æ•°
3. **æ„å»ºæµç¨‹**: ä½¿ç”¨æä¾›çš„è‡ªåŠ¨åŒ–è„šæœ¬ç®€åŒ–æ„å»ºè¿‡ç¨‹
4. **åŸç”ŸåŠŸèƒ½**: å……åˆ†åˆ©ç”¨Capacitoræä¾›çš„åŸç”Ÿèƒ½åŠ›
5. **å­˜å‚¨é…ç½®**: æ­£ç¡®è®¾ç½®Supabaseå­˜å‚¨æ¡¶æ”¯æŒå›¾ç‰‡ä¸Šä¼ 
6. **CI/CD**: å®æ–½è‡ªåŠ¨åŒ–æ„å»ºå’Œéƒ¨ç½²æµç¨‹
7. **æ€§èƒ½ä¼˜åŒ–**: é‡‡ç”¨å¤šç§ç­–ç•¥æå‡åº”ç”¨æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ

é€šè¿‡éµå¾ªè¿™äº›æŒ‡å¯¼åŸåˆ™å’Œæœ€ä½³å®è·µï¼Œå¼€å‘è€…å¯ä»¥é«˜æ•ˆåœ°æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²Focus Doåº”ç”¨ï¼Œç¡®ä¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æä¾›ä¼˜è´¨çš„ç”¨æˆ·ä½“éªŒã€‚